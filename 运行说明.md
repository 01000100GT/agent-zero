# **Agent Zero: 本地源码运行说明手册**

本手册将详细指导你如何在本地环境中从源码运行 Agent Zero 项目。

---

### **1. 环境准备与依赖安装**

在开始之前，请确保你的系统满足以下环境要求，并安装所有必要的依赖。

#### **1.1 环境要求**

*   **Python**: **Python 3.12 或更高版本**。此项目使用了 Python 3.12 引入的 `typing.override` 特性。
    *   你可以通过 `python3 --version` 命令来检查你的 Python 版本。
*   **Git**: 用于克隆 Agent Zero 项目仓库。
    *   通过 `git --version` 检查 Git 是否安装。
*   **虚拟环境 (推荐)**: 强烈建议使用 Python  virtual environment（如 `venv` 或 `uv`），以避免项目依赖与系统其他 Python 项目冲突。

#### **1.2 克隆项目**

打开你的终端或命令行工具，执行以下命令克隆 Agent Zero 的代码仓库：

```bash
git clone https://github.com/agent0ai/agent-zero.git
cd agent-zero
```

#### **1.3 创建并激活虚拟环境**

进入项目目录后，使用你的 Python 3.12+ 解释器创建并激活一个虚拟环境：

```bash
# 使用 Python 3.12+ 创建虚拟环境 (名为 '.agentzerovenv')
python3.12 -m venv .agentzerovenv

# 激活虚拟环境
# 对于 macOS/Linux:
source .agentzerovenv/bin/activate

# 对于 Windows (Command Prompt):
.\.agentzerovenv\Scripts\activate.bat

# 对于 Windows (PowerShell):
.\.agentzerovenv\Scripts\Activate.ps1
```
激活后，你的命令行提示符前会显示 `(.agentzerovenv)`，表示你已进入虚拟环境。

#### **1.4 安装项目依赖**

在激活虚拟环境后，安装 `requirements.txt` 文件中列出的所有 Python 依赖：

```bash
pip install -r requirements.txt
```
这个过程可能需要几分钟，因为它会下载和安装所有 Agent Zero 及其工具所需的库。

---

### **2. 配置与启动**

在安装完所有依赖后，你需要进行一些基本配置才能启动 Agent Zero。

#### **2.1 配置环境变量 (.env 文件)**

Agent Zero 使用 `.env` 文件来管理敏感信息和一些核心配置。

1.  **创建 `.env` 文件**: 在项目根目录下，复制 `example.env` 文件并将其重命名为 `.env`：
    ```bash
    cp example.env .env
    ```
2.  **编辑 `.env` 文件**: 使用文本编辑器打开 `.env` 文件进行配置。

---

### **3. 如何连接到 OpenAI 兼容接口 (例如本地 LLM)**

您提出了一个很好的问题，关于如何连接到非官方但与 OpenAI API 兼容的服务（例如 `Ollama`, `LM Studio`, `Groq` 或其他私有部署模型）。Agent Zero 通过一个通用的提供商类型来支持此功能。

#### **3.1 理解工作原理**

Agent Zero 内置了一个名为 **"Other OpenAI compatible"** 的提供商选项。当您在设置中选择它时，系统会以标准的 OpenAI 格式发送请求，但允许您将请求指向**任何自定义的 URL 地址 (api_base)**。

#### **3.2 修改 .env 文件**

为了方便管理，建议您将自定义接口的 URL 和 API 密钥添加到您的 `.env` 文件中。请将以下文本块**添加**到您的 `.env` 文件末尾：

```ini

# --- 通用 OpenAI 兼容接口配置 ---
# 这里可以填入你本地模型服务或其他兼容服务的 URL
OPENAI_COMPATIBLE_BASE_URL="http://localhost:1234/v1"

# 这个接口对应的 API Key (如果需要的话)
# 系统会查找名为 API_KEY_OTHER 的环境变量
API_KEY_OTHER="your-custom-api-key-if-needed"
```

#### **3.3 在 Web UI 中配置**

1.  **启动 Agent Zero**: 按照第2部分的说明，运行 `python run_ui.py` 并访问 Web UI。
2.  **进入设置页面**。
3.  **配置模型**:
    *   在模型配置部分，找到 **Provider** (提供商) 下拉菜单，选择 **"Other OpenAI compatible"** 选项。
    *   在 **API Base** (接口地址) 输入框中，填入您在 `.env` 文件中设置的 URL，例如 `http://localhost:1234/v1`。
    *   在 **Model Name** (模型名称) 输入框中，填入该服务需要使用的模型名称 (例如 `lmstudio-community/Meta-Llama-3-8B-Instruct-GGUF` 或 `llama3`)。
    *   将 `.env` 文件中设置的 `API_KEY_OTHER` 密钥填入对应的 **API Key** 输入框中。
4.  **保存设置**。

完成以上步骤后，Agent Zero 就会将您的请求发送到指定的通用 OpenAI 兼容接口了。

---

### **4. 常见问题排查 (Troubleshooting)**

#### **Q1: 启动时报错 `ImportError: cannot import name 'override' from 'typing'`**

*   **原因**: 这个错误是因为您使用的 Python 版本低于 3.12。代码中的 `from typing import override` 语法仅在 Python 3.12 及以上版本中受支持。
*   **解决方案**: 请确保您创建虚拟环境并运行时，使用的是 **Python 3.12 或更高版本**的解释器。请参照 **1.1 环境要求** 和 **1.3 创建并激活虚拟环境** 部分的说明，使用正确的 Python 版本重新创建虚拟环境。

#### **Q2: 启动时看到 `No RFC password` 或 `No module named pip` 错误**

*   **原因**: 这些错误是在源码开发模式下运行时的**正常现象**。Agent Zero 的架构深度依赖其标准的 Docker 环境，在 Docker 中，不同进程间的通信（RFC）和环境会自动配置好。当直接从源码运行时，这些机制可能没有被完全初始化。
*   **解决方案**: **您可以安全地忽略这些错误**。只要您看到绿色的 `* Running on http://localhost:50001` 信息，就表示核心的 Web 服务已经成功启动。这些错误不会影响核心的聊天、工具使用和记忆功能。

#### **Q3: 启动时看到 `SSLError` 或 `MaxRetryError`，无法从 `huggingface.co` 下载模型**

*   **原因**: 这是一个网络连接问题。您的网络环境（如防火墙、代理或网络过滤）阻止了程序与 Hugging Face 服务器建立稳定的加密连接，导致模型文件下载失败。
*   **解决方案 (推荐)**: **配置网络代理**。如果您有可用的网络代理，可以在 `.env` 文件中添加以下配置，并修改为您自己的代理地址和端口：
    ```ini
    
    # --- 网络代理配置 ---
    # 将 http://127.0.0.1:7890 替换为你的代理服务器地址
    HTTP_PROXY="http://1.1.1.1:8080"
    HTTPS_PROXY="http://1.1.1.1:8080"
    ```
    添加后，保存文件并重启 `python run_ui.py`。
*   **备用方案**: 手动从 `huggingface.co` 下载模型文件，并放置到 Python 库的缓存目录中。这是一个更复杂的方案，仅在无法配置代理时考虑。
